<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Okey Grand Master - Full Project</title>
    
    <!-- External Libraries -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            --gold: linear-gradient(135deg, #f1c40f 0%, #d4ac0d 100%);
            --diamond: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            --emerald: radial-gradient(circle, #064e3b 0%, #022c22 100%);
            --glass: rgba(255, 255, 255, 0.08);
            --bg-dark: #050505;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; background: var(--bg-dark); font-family: 'Segoe UI', sans-serif; color: white; overflow: hidden; height: 100vh; }

        /* --- Screens --- */
        .screen { display: none; height: 100vh; width: 100vw; flex-direction: column; overflow: hidden; animation: fadeIn 0.4s ease; }
        .screen.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Top Bar Stats --- */
        .top-stats { height: 60px; background: #111; display: flex; justify-content: space-between; align-items: center; padding: 0 15px; border-bottom: 2px solid #d4ac0d; }
        .cur-box { background: rgba(0,0,0,0.6); padding: 5px 12px; border-radius: 20px; border: 1px solid #f1c40f; color: #f1c40f; font-weight: 800; font-size: 13px; display: flex; align-items: center; gap: 5px; }
        .cur-box.dia { border-color: #00d2ff; color: #00d2ff; }

        /* --- 1. Login/Splash Screen --- */
        #loginScreen { background: radial-gradient(circle, #2c3e50, #000); justify-content: center; align-items: center; text-align: center; }
        .logo-main { font-size: 50px; color: #f1c40f; text-shadow: 0 0 20px #f1c40f; font-weight: 900; margin-bottom: 20px; }
        .btn-gold { background: var(--gold); border: none; padding: 15px 60px; border-radius: 30px; font-weight: 900; font-size: 18px; cursor: pointer; color: #333; }

        /* --- 2. Elite Lobby (6 Tables) --- */
        .lobby-info { text-align: center; padding: 8px; font-size: 12px; color: #4ade80; background: rgba(74, 222, 128, 0.1); }
        .grid-tables { flex: 1; overflow-y: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 15px; padding-bottom: 100px; }
        .t-card { background: var(--glass); border-radius: 25px; padding: 20px 10px; text-align: center; border: 1px solid rgba(255,255,255,0.05); backdrop-filter: blur(15px); position: relative; }
        .t-card h4 { color: gold; margin: 8px 0; font-size: 14px; }
        .t-bet { font-size: 20px; font-weight: 900; }
        .view-players { font-size: 10px; color: #3498db; margin-top: 5px; cursor: pointer; }

        /* --- 3. VIP Profile Screen --- */
        #profileScreen { background: #000; }
        .p-header { padding: 40px 20px; text-align: center; background: radial-gradient(circle, #222, #000); border-bottom: 2px solid gold; }
        .p-av-big { width: 100px; height: 100px; border-radius: 50%; border: 3px solid gold; box-shadow: 0 0 20px gold; }
        .xp-bar { width: 80%; height: 8px; background: #333; margin: 15px auto; border-radius: 5px; overflow: hidden; }
        .xp-fill { width: 70%; height: 100%; background: var(--gold); }
        .p-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 20px; }
        .p-stat-box { background: var(--glass); padding: 15px 5px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }

        /* --- 4. Rewards (Daily & Spin) --- */
        .reward-area { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px; }
        .wheel-box { position: relative; width: 280px; height: 280px; border: 8px solid gold; border-radius: 50%; transition: transform 4s cubic-bezier(0.1, 0, 0.1, 1); background: conic-gradient(#ef4444 0deg 60deg, #3b82f6 60deg 120deg, #f59e0b 120deg 180deg, #10b981 180deg 240deg, #8b5cf6 240deg 300deg, #f97316 300deg 360deg); }
        .wheel-ptr { position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid white; z-index: 10; }

        /* --- 5. Gameplay Screen --- */
        .game-table { flex: 1; margin: 10px; background: var(--emerald); border: 8px solid #1e293b; border-radius: 50px; position: relative; box-shadow: inset 0 0 100px #000; }
        .player { position: absolute; display: flex; flex-direction: column; align-items: center; z-index: 10; }
        .av-ring { width: 50px; height: 50px; border-radius: 50%; border: 2px solid white; position: relative; background: #333; }
        .active-p .av-ring { border-color: gold; box-shadow: 0 0 15px gold; }
        
        /* Floating Emoji Logic */
        .emoji-pop { position: absolute; font-size: 30px; bottom: 60px; display: none; animation: floatUp 2s forwards; z-index: 50; }
        @keyframes floatUp { 0% { opacity: 0; transform: translateY(0); } 20% { opacity: 1; transform: translateY(-30px) scale(1.2); } 100% { opacity: 0; transform: translateY(-80px); } }

        .p-top { top: 10px; left: 50%; transform: translateX(-50%); }
        .p-left { left: 15px; top: 35%; }
        .p-right { right: 15px; top: 35%; }

        .deck-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .draw-btn { width: 55px; height: 75px; background: white; border-radius: 5px; box-shadow: 0 5px 0 #ccc; color: #111; font-weight: 900; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* Rack Logic */
        .rack-container { height: 235px; background: #1a0f0a; border-top: 5px solid #000; padding: 10px; display: flex; flex-direction: column; align-items: center; gap: 5px; background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png'); }
        .rack-row { display: grid; grid-template-columns: repeat(14, 1fr); gap: 5px; width: 98%; max-width: 850px; height: 90px; }
        .tile { background: white; border-radius: 4px; aspect-ratio: 2/2.8; display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: 900; color: #222; box-shadow: 0 4px 0 #ddd; cursor: pointer; }
        
        .red { color: #dc2626; } .blue { color: #2563eb; } .black { color: #111; } .yellow { color: #d97706; }

        /* --- Global Nav --- */
        .bottom-nav { height: 75px; background: #111; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #333; position: fixed; bottom: 0; width: 100%; z-index: 1000; }
        .nav-link { display: flex; flex-direction: column; align-items: center; font-size: 11px; color: #777; cursor: pointer; }
        .nav-link.active { color: #f1c40f; }
        .nav-link i { font-size: 22px; margin-bottom: 5px; }

    </style>
</head>
<body>

    <!-- Header Stats (Visible in App) -->
    <div id="appHeader" class="top-stats" style="display:none;">
        <div style="display:flex; align-items:center; gap:10px;">
            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=VIP" style="width:38px; border-radius:50%; border:2px solid gold;">
            <span style="font-size:12px;"><b>Melinde B.</b></span>
        </div>
        <div class="currency-container" style="display:flex; gap:8px;">
            <div class="cur-box"><i class="fas fa-coins"></i> <span id="coins">250,500</span></div>
            <div class="cur-box dia"><i class="fas fa-gem"></i> <span id="diamonds">150</span></div>
        </div>
    </div>

    <!-- 1. LOGIN / SPLASH -->
    <div id="loginScreen" class="screen active">
        <div class="logo-main">OKEY PLUS<br><span style="font-size:25px;">ULTIMATE</span></div>
        <button class="btn-gold" onclick="showScreen('lobbyScreen')">Ø¯Û•Ø³ØªÙ¾ÛÚ©Ø±Ø¯Ù†</button>
    </div>

    <!-- 2. LOBBY (6 TABLES) -->
    <div id="lobbyScreen" class="screen">
        <div class="lobby-info"><i class="fas fa-circle" style="font-size:8px;"></i> Ù¡,Ù¥Ù¤Ù  ÛŒØ§Ø±ÛŒØ²Ø§Ù† Ø¦Û†Ù†Ù„Ø§ÛŒÙ†Ù†</div>
        <div class="grid-tables" id="tablesList"></div>
    </div>

    <!-- 3. PROFILE -->
    <div id="profileScreen" class="screen">
        <div class="p-header">
            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=VIP" class="p-av-big">
            <h2>Melinde B. <i class="fas fa-crown" style="color:gold;"></i></h2>
            <div class="xp-bar"><div class="xp-fill"></div></div>
            <p style="font-size:12px; color:gold;">Master Level 56</p>
        </div>
        <div class="p-stats">
            <div class="p-stat-box"><b>1,540</b>ÛŒØ§Ø±ÛŒ</div>
            <div class="p-stat-box"><b>89%</b>Ø¨Ø±Ø¯Ù†Û•ÙˆÛ•</div>
            <div class="p-stat-box"><b>#124</b>Ù¾Ù„Û•</div>
        </div>
        <div style="padding:20px;">
            <button class="btn-gold" style="width:100%; background:var(--diamond); color:white;" onclick="inviteFriend()">Ø¨Ø§Ù†Ú¯Ù‡ÛØ´ØªÚ©Ø±Ø¯Ù†ÛŒ Ù‡Ø§ÙˆÚ•ÛÛŒØ§Ù† (+50 ğŸ’)</button>
        </div>
    </div>

    <!-- 4. REWARDS -->
    <div id="rewardScreen" class="screen">
        <div class="reward-area">
            <button class="btn-gold" onclick="alert('Ø®Û•ÚµØ§ØªÛŒ Ú•Û†Ú˜Ø§Ù†Û•Øª ÙˆÛ•Ø±Ú¯Ø±Øª! +5,000 ğŸ’°')">Ø®Û•ÚµØ§ØªÛŒ Ú•Û†Ú˜Ø§Ù†Û•</button>
            <div style="position:relative;">
                <div class="wheel-ptr"></div>
                <div id="wheel" class="wheel-box"></div>
            </div>
            <button class="btn-gold" onclick="spinWheel()">Ø¦ÛØ³ØªØ§ Ø¨ÛŒØ®ÙˆÙ„ÛÙ†Û•ÙˆÛ•</button>
        </div>
    </div>

    <!-- 5. GAME ARENA -->
    <div id="gameScreen" class="screen">
        <div class="game-table">
            <div class="player p-top"><div class="av-ring"><img src="https://api.dicebear.com/7.x/avataaars/svg?seed=A" style="width:100%"></div></div>
            <div class="player p-left active-p"><div class="av-ring"><img src="https://api.dicebear.com/7.x/avataaars/svg?seed=B" style="width:100%"></div><div class="emoji-pop" id="emoji-pop">ğŸ˜‚</div></div>
            <div class="player p-right"><div class="av-ring"><img src="https://api.dicebear.com/7.x/avataaars/svg?seed=C" style="width:100%"></div></div>

            <div class="deck-center">
                <div class="draw-btn" onclick="drawTile()">Draw</div>
                <div id="gameMsg" style="margin-top:15px; font-size:12px; font-weight:bold; color:gold;">Ù†Û†Ø±Û•ÛŒ ØªÛ†ÛŒÛ•</div>
            </div>

            <!-- Reaction Btn -->
            <div style="position:absolute; left:15px; bottom:15px; font-size:24px;" onclick="sendEmoji()"><i class="fas fa-laugh-beam" style="color:gold;"></i></div>
        </div>
        <div class="rack-container">
            <div class="rack-row" id="row1"></div>
            <div class="rack-row" id="row2"></div>
        </div>
    </div>

    <!-- Bottom Nav -->
    <div id="bottomNav" class="bottom-nav" style="display:none;">
        <div class="nav-link active" onclick="showScreen('lobbyScreen', this)"><i class="fas fa-th-large"></i>Ù…ÛØ²Û•Ú©Ø§Ù†</div>
        <div class="nav-link" onclick="showScreen('rewardScreen', this)"><i class="fas fa-gift"></i>Ø®Û•ÚµØ§Øª</div>
        <div class="nav-link" onclick="showScreen('profileScreen', this)"><i class="fas fa-user-circle"></i>Ù¾Ú•Û†ÙØ§ÛŒÙ„</div>
    </div>

    <!-- Audio (External) -->
    <audio id="drawSnd" src="https://assets.mixkit.co/sfx/preview/mixkit-card-game-single-card-flip-744.mp3"></audio>
    <audio id="discardSnd" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-jump-down-2849.mp3"></audio>

    <script>
        const colors = ['red', 'blue', 'black', 'yellow'];
        let myTilesCount = 14;

        // 1. Navigation
        function showScreen(id, el) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            const header = document.getElementById('appHeader');
            const nav = document.getElementById('bottomNav');
            
            if(id === 'loginScreen') { header.style.display = 'none'; nav.style.display = 'none'; }
            else { header.style.display = 'flex'; nav.style.display = 'flex'; }

            if(el) {
                document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
            if(id === 'gameScreen') initGame();
            if(window.Telegram) window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
        }

        // 2. Build 6 Tables
        function buildLobby() {
            const list = document.getElementById('tablesList');
            const tables = [
                {n: "Knights Hall", b: "5K", p: "4"}, {n: "VIP Lounge", b: "50K", p: "2"},
                {n: "Grand Arena", b: "100K", p: "4"}, {n: "Speed Run", b: "25K", p: "2"},
                {n: "Diamond Club", b: "500K", p: "4"}, {n: "Legend Cup", b: "1M", p: "4"}
            ];
            list.innerHTML = '';
            tables.forEach(t => {
                const card = document.createElement('div');
                card.className = 't-card';
                card.innerHTML = `<h4>${t.n}</h4><div class="t-bet">ğŸ’° ${t.b}</div><div class="view-players" onclick="alert('ÛŒØ§Ø±ÛŒØ²Ø§Ù†Û•Ú©Ø§Ù†: Ù‡Ø§ÙˆÚ©Ø§Ø±ØŒ Ø³Ø§Ø²Ú¯Ø§Ø±ØŒ Ø´ÙˆØ§Ù†')">View Players</div><br><button class="btn-gold" style="padding:6px 20px; font-size:12px;" onclick="showScreen('gameScreen')">Play</button>`;
                list.appendChild(card);
            });
        }

        // 3. Game Logic (14/15 Rule)
        function initGame() {
            const r1 = document.getElementById('row1');
            const r2 = document.getElementById('row2');
            r1.innerHTML = ''; r2.innerHTML = '';
            for(let i=0; i<14; i++) {
                (i < 7 ? r1 : r2).appendChild(createTile());
            }
            myTilesCount = 14;
            updateStatus();
        }

        function createTile() {
            const num = Math.floor(Math.random() * 13) + 1;
            const color = colors[Math.floor(Math.random() * 4)];
            const div = document.createElement('div');
            div.className = `tile ${color}`;
            div.innerHTML = `<span>${num}</span>`;
            div.onclick = () => {
                if(myTilesCount === 15) {
                    div.remove();
                    myTilesCount = 14;
                    document.getElementById('discardSnd').play();
                    updateStatus();
                    if(window.Telegram) window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
                } else {
                    alert("Ø³Û•Ø±Û•ØªØ§ Ø¨Û•Ø±Ø¯ÛÚ© Ú•Ø§Ø¨Ú©ÛØ´Û•!");
                }
            };
            return div;
        }

        function drawTile() {
            if(myTilesCount === 14) {
                document.getElementById('row1').appendChild(createTile());
                myTilesCount = 15;
                document.getElementById('drawSnd').play();
                updateStatus();
                if(window.Telegram) window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
            }
        }

        function updateStatus() {
            const msg = document.getElementById('gameMsg');
            msg.innerText = myTilesCount === 14 ? "Ù†Û†Ø±Û•ÛŒ ØªÛ†ÛŒÛ•: Ø¨Û•Ø±Ø¯ÛÚ© Ú•Ø§Ø¨Ú©ÛØ´Û•" : "Ù¡Ù¥ Ø¨Û•Ø±Ø¯: Ø¯Ø§Ù†Û•ÛŒÛ•Ú© ÙÚ•Û Ø¨Ø¯Û•";
            msg.style.color = myTilesCount === 14 ? "gold" : "#ff4757";
        }

        // 4. Rewards & Social
        let spinning = false;
        function spinWheel() {
            if(spinning) return;
            spinning = true;
            const wheel = document.getElementById('wheel');
            const deg = Math.floor(Math.random() * 3600) + 1440;
            wheel.style.transform = `rotate(${deg}deg)`;
            setTimeout(() => { spinning = false; alert("Ù¾ÛŒØ±Û†Ø²Û•! Ù¢Ù ,Ù Ù Ù  Ú©Û†ÛŒÙ†Øª Ø¨Ø±Ø¯Û•ÙˆÛ•!"); }, 4000);
        }

        function sendEmoji() {
            const emojis = ['ğŸ˜‚', 'ğŸ”¥', 'ğŸ˜±', 'ğŸ‘', 'ğŸ˜¡'];
            const pop = document.getElementById('emoji-pop');
            pop.innerText = emojis[Math.floor(Math.random()*emojis.length)];
            pop.style.display = 'block';
            setTimeout(() => pop.style.display = 'none', 2000);
        }

        function inviteFriend() {
            if(window.Telegram) {
                window.Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=https://t.me/YourBot&text=ÙˆÛ•Ø±Û• Ø¦Û†Ú©Û•ÛŒ Ø¨Ú©Û•ÛŒÙ†! ğŸ’`);
            }
        }

        // Sortable Setup
        [document.getElementById('row1'), document.getElementById('row2')].forEach(r => {
            new Sortable(r, { group: 'okey', animation: 150 });
        });

        // Start
        buildLobby();
        if(window.Telegram) window.Telegram.WebApp.expand();

    </script>
</body>
</html>